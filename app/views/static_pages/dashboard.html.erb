<% provide(:title, 'Dashboard') %>

<header class="header-static-gray">
  <%= render 'layouts/header_secondary' %>
</header>

<%= render 'layouts/modal_search' %>

<%= render 'layouts/modal_menu' %>

<%= render 'layouts/hero_backend' %>

<nav class="secondary-navbar hidden-xs">
  <div class="secondary-navbar-nav">
    <ul class="nav navbar-nav navbar-left">
      <li><%= link_to "Dashboard",   dashboard_path, class: "nav-active" %></li>
      <li><%= link_to "Inbox",       conversations_path %></li>
      <li><%= link_to "Your Garage", vehicles_path %></li>
      <li><%= link_to "Showroom",    test_drives_path %></li>
      <li><%= link_to "Profile",     edit_user_path(current_user) %></li>
    </ul>
  </div>
</nav>

<nav class="dropdown dropdown-backend visible-xs-block">
  
  <a href='#' class="dropdown-toggle" data-toggle="dropdown">
    Dashboard <b class="caret"></b>
  </a>
  
  <ul class="dropdown-menu">
    <li><%= link_to "Dashboard",   dashboard_path, class: "dropdown-active" %></li>
    <li><%= link_to "Inbox",       conversations_path %></li>
    <li><%= link_to "Your Garage", vehicles_path %></li>
    <li><%= link_to "Showroom",    test_drives_path %></li>
    <li><%= link_to "Profile",     edit_user_path(current_user) %></li>
  </ul>
</nav>

<div class="backend">
  <div class="backend-content">
    
    <div class="dashboard-notifications">
      
      <h2 class="dashboard-title">Notifications</h3>
      
      <ul class="nav nav-tabs dashboard-tabs">
        
        <li class="active">
          <a href="#requests_and_inquiries" data-toggle="tab">
            Messages (<%= @conversations.count %>)
          </a>
        </li>
        
        <li>
          <a href="#questions" data-toggle="tab">
            Questions (<%= @questions.count %>)
          </a>
        </li>
      </ul>
      
      <div class="tab-content dashboard-tab-content">
        
        <div class="tab-pane fade active in" id="requests_and_inquiries">
          <% if @conversations.exists? %>
            <ol class="tab-pane-list">
              <%= render partial:    "new_conversation", 
                         collection: @conversations, 
                         as:         :conversation %>
            </ol>
          
          <% else %>
            <p class="empty-list-info">
              No recent messages or questions
            </p> 
          <% end %>
        </div>
        
        <div class="tab-pane fade" id="questions">
          <% if @questions.exists? %>
            <ol class="tab-pane-list">
              <%= render partial:    "new_question", 
                         collection: @questions, 
                         as:         :question %>
            </ol>
          
          <% else %>
            <p class="empty-list-info">
              You have not received any questions.
            </p>
          <% end %>
        </div>
      </div>
    </div>
    
    <div class="dashboard-test-drives">  
    
      <h2 class="dashboard-title">Customer Test Drives</h2>
      
      <% if @customers.exists? %>
        <ol class="dashboard-list">
          <%= render partial: "customer", collection: @customers %>
        </ol>
      
      <% else %>
        <!--<div class="empty-list">-->
            
        <!--  <i class="fa fa-tachometer fa-4x empty-list-icon" -->
        <!--     aria-hidden="true"></i>-->
             
          <p class="empty-list-info">
            You have not accepted any test drive requests.
          </p>
        <!--</div>-->
      <% end %>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
    
    // image scaling
    
      var conversationAvatar = $('.conversation-avatar');
      
      conversationAvatar.imagefill(); 
  })
</script>

<!--incorporate logged_in into dashboard-->