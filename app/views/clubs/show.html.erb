<% provide(:title, @club.name) %>

<header class="header-static-gray">
  <%= render 'layouts/header_secondary' %>
</header>

<%= render 'layouts/modal_search' %>

<%= render 'layouts/modal_menu' %>

<div class="club-profile">
  
  <ol class="social-nav">
    
    <li class="hidden-xs">
      <%= link_to "Community Center", posts_path, class: "social-nav-link" %>
    </li>
    
    <li>
      
      <i class="fa fa-angle-left social-nav-separator-mobile visible-xs" 
         aria-hidden="true"></i>
      
      <i class="fa fa-angle-right social-nav-separator hidden-xs" 
         aria-hidden="true"></i>
         
      <%= link_to "Car Clubs", clubs_path, class: "social-nav-link" %>
    </li>
    
    <li class="hidden-xs">
      
      <i class="fa fa-angle-right social-nav-separator" 
         aria-hidden="true"></i>
         
      <span class="social-nav-active"><%= @club.name %></span>
    </li>
  </ol>
  
  <div class="row">
    
    <div class="col-md-4 col-md-offset-1 col-md-push-7">
      
      <!--<(perc)= form_tag search_clubs_path, -->
      <!--            method: :get, -->
      <!--            class: "search-form-forum" do %>-->
                   
      <!--  <i class="fa fa-search fa-lg search-bar-primary-icon" -->
      <!--    aria-hidden="true"></i>-->
          
      <!--  <(perc)= text_field_tag :city, -->
      <!--                    params[:city], -->
      <!--                    placeholder: "City (Eg. Detroit, MI)", -->
      <!--                    class: "form-control -->
      <!--                            search-form-control-->
      <!--                            typeahead" %>-->
                           
      <!--  <(perc)= submit_tag "Search", class: "btn-forum" %>-->
      <!--<(perc) end %>-->
      
      <div class="club-profile-cover-photo visible-xs" 
           style="background-image: url(
                   '<%= @club.cover_photo.url() if 
                        @club.cover_photo.exists? %>')">
      </div>
      
      <h1 class="club-profile-title"><%= @club.name %></h1>
      
      <%= link_to "Update", 
                  edit_club_path,
                  class: "club-profile-update" if 
                    ( logged_in? && 
                      current_user.
                        memberships.
                        where(club_id: @club.id, admin: true).
                        exists? ) %>

      <p class="club-profile-info"><%= @club.description %></p>
      
      <div class="club-profile-buttons">
        
        <%= link_to "Send Invitations",
                    new_club_invitation_path(@club),
                    class: "btn btn-club-invitation" if 
                      ( logged_in? && 
                        current_user.
                          memberships.
                          where(club_id: @club.id, admin: true).
                          exists? ) %>
                          
        <% if logged_in? && 
              current_user.memberships.where(club_id: @club.id).exists? %>
          <%= link_to "Start A Conversation", 
                      new_post_path(club_id: @club.id), 
                      class: "btn btn-club-conversation" %>
        
        <% else %>
          <%= link_to "Join Club", 
                      join_club_path(@club), 
                      method: :put,
                      class: "btn btn-club-conversation" %>
        <% end %>
      </div>

      <div class="club-members">
      
        <span class="club-members-title">Members</span>
        
        <ol class="club-members-list">
          <%= render partial:    "club_member", 
                     collection: @club.memberships,
                     as:         :member %>
        </ol>
      </div>
    </div>
    
    <div class="col-md-7 col-md-pull-5">
      
      <div class="club-profile-cover-photo hidden-xs" 
           style="background-image: url(
                   '<%= @club.cover_photo.url() if 
                        @club.cover_photo.exists? %>')">
      </div>
      
      <div class="club-profile-feed-detail">
        <h2 class="club-profile-feed-title">Recent Conversations</h2>
      </div>
      
      <div class="club-profile-feed">
      
        <% if logged_in? && 
              current_user.memberships.where(club_id: @club.id).exists? && 
              @posts.any? %>
          <ol class="club-posts-list">
            <%= render partial:    "posts/post", 
                       collection: @posts,
                       as:         :post %>
          </ol>
        
        <% elsif logged_in? && 
                 current_user.memberships.where(club_id: @club.id).exists? %>
          <p class="empty-list-info">
            No recent conversations
          </p> 

        <% else %>
          <p class="empty-list-info">
            This is a closed group; ask to join the club in order to view 
            content.
          </p>
        <% end %>
      </div>
    </div>
  </div>
</div>