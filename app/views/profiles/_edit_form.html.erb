<!--complete-->

<%= form_for @profile, html: { multipart: true } do |f| %>
                     
  <%= render 'shared/error_messages', object: f.object %>
  
  <div class="update-panel">
    <div class="panel-header">
      <span class="panel-title">Profile Photo</span>
    </div>
    
    <div class="row vertical-align panel-body">
        
      <div class="col-md-4 avatar-container">
        <%= image_tag @profile.avatar.url, class: "avatar" %>
      </div>
      
      <div class="col-md-8 avatar-instructions">
        <p class="avatar-instructions-text">
          Clear frontal face photos are an important way for sellers and 
          buyers to learn about each other. 
        </p>
        
        <div class="button-container">
          <div class="avatar-instructions-button">
            Upload Photo
          </div>
          
          <%= f.file_field :avatar, class: "avatar-upload" %>
        </div>
      </div>
    </div>
  </div>
      
  <div class="update-panel">
    <div class="panel-header">
      <h2 class="panel-title">Optional</h2>
    </div>
    
    <div class="panel-content credentials">
      <div class="row form-group form-group-horizontal">
        
          <div class="col-md-3">
            <%= f.label :description, "Describe Yourself" %>
          </div>
          
          <div class="col-md-9">
            <%= f.text_area :description, 
                rows: 5,
                placeholder: (@profile.description.present? ? 
                              @profile.description : "Dealership.com is built on relationships. Help other people get to know you."), 
                class: 'form-control form-control-primary' %>
          </div>
      </div>
      
      <div class="row form-group form-group-horizontal">
        
          <div class="col-md-3">
            <%= f.label :residence, "City of residence" %>
          </div>
          
          <div class="col-md-9">
            <%= f.text_field :residence, 
                placeholder: "E.g. Paris, France / Brooklyn, NY / Chicago, IL", 
                class: 'form-control form-control-primary' %>
          </div>
      </div>
      
      <div class="row form-group form-group-horizontal">
        
          <div class="col-md-3">
            <%= f.label :school %>
          </div>
          
          <div class="col-md-9">
            <%= f.text_field :school, 
                placeholder: "University of Michigan", 
                class: 'form-control form-control-primary' %>
          </div>
      </div>
      
      <div class="row form-group form-group-horizontal">
        
          <div class="col-md-3">
            <%= f.label :work %>
          </div>
          
          <div class="col-md-9">
            <%= f.text_field :work, 
                placeholder: "Company name or job title", 
                class: 'form-control form-control-primary' %>
          </div>
      </div>
    </div>
  </div>
  
  <%= f.submit "Save Changes", class: "btn btn-primary" %>
<% end %>

<script type="text/javascript">
  $(document).ready(function() {

    // image preview
    var avatar       = $('.avatar');
    var avatarUpload = $('.avatar-upload')
    
    function readURL(input) {
      if (input.files && input.files[0]) {
        var reader = new FileReader();
      
        reader.onload = function (e) {
          avatar.attr('src', e.target.result);
        }
    
        reader.readAsDataURL(input.files[0]);
      }
    }
    
   avatarUpload.change(function(){
        readURL(this);
    });
  });
</script>