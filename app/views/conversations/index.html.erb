<!--completed-->

<% provide(:title, "Inbox") %>

<header class="header-static-gray">
  <%= render 'layouts/header_secondary' %>
</header>

<%= render 'layouts/hero_backend' %>

<nav class="secondary-navbar">
  <div class="secondary-navbar-nav">
    <ul class="nav navbar-nav navbar-left">
      <li><%= link_to "Dashboard",   dashboard_path %></li>
      <li><%= link_to "Inbox",  conversations_path, class: "nav-active" %></li>
      <li><%= link_to "Garage",      vehicles_path %></li>
      <li><%= link_to "Test Drives", test_drives_path %></li>
      <li><%= link_to "Profile",     edit_user_path(current_user) %></li>
    </ul>
  </div>
</nav>

<div class="backend">
  <div class="backend-content">
    <div class="row">
      
      <div class="col-xs-4 sidenav">

        <h2 class="sidenav-title">
          Inbox
        </h2>
        
        <ul class="sidenav-list">
          <li>
            
            <% conversation_count = 0 %>
            <% @conversations.each do |conversation| %>
              <% conversation_count += 1 if conversation.messages.exists? %>
            <% end %>
            
            <%= link_to conversations_path, class: "sidenav-active" do %>
              Messages (<%= conversation_count %>)
            <% end %>
          </li>
        </ul>
      </div>
      
      <div class="col-xs-8">
        
        <% if conversation_count != 0 %>
          <ol class="backend-list">
            <%= render @conversations %>
          </ol>
          
        <% else %>
          <div class="empty-list">
          
            <i class="fa fa-envelope-o fa-4x empty-list-icon" 
               aria-hidden="true"></i>
               
            <p class="empty-list-info">
              No messages, yet.
            </p>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>

<!--must login iot access-->
<!--what if there are no messages-->
<!--number should only indicate new messages-->
<!--simplify conversation_count-->